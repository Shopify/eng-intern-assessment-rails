<h1>Encyclopedia Shopifedica</h1>

<%= form_with model: Article.new, url: articles_path ,local: true do |form| %>
    <h3>Create New Article</h3>
    <div>
      <%= form.label :title %>
      <%= form.text_field :title, required: true %>
    </div>
  
    <div>
      <%= form.label :author %>
      <%= form.text_field :author, required: true %>
    </div>

    <div>
      <%= form.label :date %>
      <%= form.date_field :date, required: true %>
    </div>
  
    <div>
      <%= form.label :content %>
      <%= form.text_area :content, required: true %>
    </div>

    <div>
      <%= form.submit "Add" %>
    </div>
  <% end %>

<div id="update_form" style = "display:none;">
<%= form_with model: @article, method: :patch, url: @article.new_record? ? articles_path : article_path(@article), local: true, id: "update_article_form" do |form| %>
        <h3>Update Article</h3>
        <%= form.hidden_field :id, id: 'update_article_id' %>
        <div>
            <%= form.label :title %>
            <%= form.text_field :title, required: true, id: 'update_article_title' %>
        </div>
  
        <div>
            <%= form.label :author %>
            <%= form.text_field :author, required: true, id: 'update_article_author' %>
        </div>

        <div>
            <%= form.label :date %>
            <%= form.date_field :date, required: true, id: 'update_article_date' %>
        </div>
  
        <div>
            <%= form.label :content %>
            <%= form.text_area :content, required: true, id: 'update_article_content' %>
        </div>

        <%= form.submit "Update Article", id: 'submit_update' %>
    <% end %>
</div>

<% if @articles %>
    <table>
        <tr>
            <th>Update</th>
            <th>Delete</th>
            <th>Title</th>
            <th>Author</th>
            <th>Date</th>
            <th>Content</th>
        </tr>
        <% @articles.each do |article| %>
            <tr>
            <td><button type="button" class="update_article" data-article-id="<%= article.id %>">Update</button></td>
                <td>
                  <%= form_with url: article_path(article), method: :delete do %>
                    <%= submit_tag 'Delete', data: { confirm: 'Are you sure?' } %>
                  <% end %>
                </td>
                <td><%= article.title %></td>
                <td><%= article.author %></td>
                <td><%= article.date %></td>
                <td><%= article.content %></td>
            </tr>
        <% end %>
    </table>
<% else %>
    <p>No articles found.</p>
<% end %>